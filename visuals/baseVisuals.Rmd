---
title: "Base Visuals"
author: "Austin Eaton"
date: "4/17/2022"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r message=FALSE, warning=FALSE}
# import libraries
library(tidyverse)
library(plyr)
library(GGally)
# import file
df <- read_csv('../NBAdraft.csv')

names(df)[9] <- "FG_college_perc"
names(df)[12] <- "2P_perc"
names(df)[15] <- "3P_perc"
names(df)[18] <- "FT_perc"
```

```{r message=FALSE, warning=FALSE}
## Top Schools ----
count(df,'School') %>% 
  arrange(freq) %>% 
  tail(n=20) %>%
  mutate(School=factor(School, levels=School)) %>%
  ggplot( aes(x=School, y=freq)) + 
  geom_segment(
    aes(x=School, xend=School, y=0, yend=freq),
    color='grey',
    # color=ifelse(School == c("Kentucky"), "orange", "grey"),
    # size=ifelse(School %in% c("Kentucky"), 1.3, 0.7)
    ) +
  geom_point(size = 3, color='orange') +
  coord_flip() +
  theme_bw() +
  xlab("School") +
  ylab("Number of Draft Picks") +
  ggtitle("Where are most draft picks coming from?") +
  annotate("text", x="Duke", y=29+1.2, 
           label="Kentucky leads the pack!", 
           color='darkorange', size=3 , angle=0, fontface="bold", hjust=1)
```
```{r message=FALSE, warning=FALSE}
## BOX PLOTS ----
ggplot(df, aes(x=lottery, y=PTS_college, fill=lottery)) +
  geom_violin() +
  geom_boxplot(width=0.4,color="grey", alpha=0.2) +
  scale_fill_manual(values=c("#999999", "#E69F00", "#56B4E9"))
  theme_bw()
  
ggplot(df, aes(x=lottery, y=MP_college, fill=lottery)) +
  geom_violin() +
  geom_boxplot(width=0.4,color="grey", alpha=0.2) +
  scale_fill_manual(values=c("#999999", "#E69F00", "#56B4E9")) +
  theme_bw() + 
  xlab("")

ggplot(df, aes(x=lottery, y=FG_college_perc, fill=lottery)) +
  geom_violin() +
  geom_boxplot(width=0.3,color="darkgrey", alpha=0.2) +
  scale_fill_manual(values=c("#999999", "#E69F00", "#56B4E9")) +
  theme_bw() + 
  xlab("")

ggplot(df, aes(x=lottery, y=`3P_perc`, fill=lottery)) +
  geom_violin() +
  geom_boxplot(width=0.3,color="#dfbb85", alpha=0.2) +
  scale_fill_manual(values=c("#999999", "#E69F00", "#56B4E9")) +
  theme_bw() + 
  xlab("")

ggplot(df, aes(x=lottery, y=`2P_perc`, fill=lottery)) +
  geom_violin() +
  geom_boxplot(width=0.3,color="#dfbb85", alpha=0.2) +
  scale_fill_manual(values=c("#999999", "#E69F00", "#56B4E9")) +
  theme_bw() + 
  xlab("")

ggplot(df, aes(x=lottery, y=FT_perc, fill=lottery)) +
  geom_violin() +
  geom_boxplot(width=0.3,color="#dfbb85", alpha=0.2) +
  scale_fill_manual(values=c("#999999", "#E69F00", "#56B4E9")) +
  theme_bw() + 
  xlab("")

ggplot(df, aes(x=lottery, y=`ORB`, fill=lottery)) +
  geom_violin() +
  geom_boxplot(width=0.3,color="#dfbb85", alpha=0.2) +
  scale_fill_manual(values=c("#999999", "#E69F00", "#56B4E9")) +
  theme_bw() + 
  xlab("")
```

```{r}
## CORRELATION MATRIX ----

df.subset <- df[c('PTS_college',"2P_perc","3P_perc","FT_perc")]
ggcorr(df.subset, method = c("everything", "pearson"))
```

```{r}
# points <- df$PTS_college
# draft.pick <- df$Pk

ggplot(df, aes(x=Pk, y=PTS_college)) +
  geom_point(
    aes(color=lottery),#, shape=lottery),
    size=2,
    alpha=0.8,
  ) +
  scale_color_manual(
    values = c("#386cb0", "#fdb462", "#7fc97f")
  ) +
  geom_smooth(method = lm, col='red') + # add linear trend line
  theme_bw() +
  xlab("Draft Pick") +
  ylab("Average Points Per Game (college)") +
  ggtitle("Comparing points scored to draft pick number")
```

```{r}
df.subset <- df[c('Pk',"2P_perc","3P_perc","FT_perc")]
df.percent <- df.subset %>% pivot_longer(!Pk, names_to = "PointType", values_to = "Percent")

library(ggridges)
ggplot(df.percent, aes(x = Percent, y = PointType, fill = PointType)) +
  geom_density_ridges() +
  theme_bw() +
  scale_y_discrete(labels=c("FT_perc" = "Free Throw", "3P_perc" = "3-Pointer", "2P_perc" = "2-Pointer")) + # change y-tick labels
  xlab("Percent Accuracy") +
  ylab("Type of Shot Attempted") +
  ggtitle("(Add Title Here)") +
  theme(legend.position = "none") # remove legend
```



Top variables:
GS,MP_college,two_P_perc,three_P,FTA,ORB,STL,SOS

